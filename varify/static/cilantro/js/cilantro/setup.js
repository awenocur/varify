define(["backbone","marionette","jquery","loglevel","./core","./ui"],function(t,e,n,i,s,r){function o(t){t=t||window.event;var e;e=t.type in c?c[t.type]:!this[l],e===!0?s.trigger("visible"):e===!1&&s.trigger("hidden")}s.templates.set(s.config.get("templates",{})),s.controls.set(s.config.get("controls",{}));var a=e.TemplateCache.prototype.loadTemplate,u=e.TemplateCache.prototype.compileTemplate;e.TemplateCache.prototype.loadTemplate=function(t){var e=s.templates.get(t);return e||(e=a.call(this,t)),e},e.TemplateCache.prototype.compileTemplate=function(t){return"function"!=typeof t&&(t=u(t)),t};var h=new r.Notifications({id:"cilantro-notifications"});n("body").append(h.render().el),s.notify=h.notify,n.ajaxPrefilter(function(t){t.xhrFields={withCredentials:!0}}),s.config.get("debug")&&(i.setLevel("debug"),s.on("all",function(){i.info.apply(i.info,[].slice.call(arguments,0))})),n(window).on("beforeunload",function(){return!s.config.get("debug")&&n.hasPendingRequest()?"Wow, you're quick! Your data is being saved. It will only take a moment.":void 0}),n(document).ajaxError(function(t,e,n,i){0===e.status||i||s.notify({timeout:null,dismissable:!1,level:"error",header:"Uh oh.",message:'There is a communication problem with the server. <a href="#" onclick="location.reload()">Refreshing</a> the page may help.'})}),n(document).on("click","a",function(e){if(s.router){var n=this.pathname;"/"!==n.charAt(0)&&(n="/"+n);var i=t.history.root||"/";n.slice(0,i.length)===i&&(n=n.slice(i.length)),s.router.hasRoute(n)&&(e.preventDefault(),s.router.navigate(n,{trigger:!0}))}}),n(document).on("click","[data-route]",function(t){if(s.router){var e=n(t.target).attr("data-route");s.router.isNavigable(e)&&(t.preventDefault(),s.router.navigate(e,{trigger:!0}))}});var l="hidden",c={focus:!0,focusin:!0,pageshow:!0,blur:!1,focusout:!1,pagehide:!1};l in document?document.addEventListener("visibilitychange",o):(l="mozHidden")in document?document.addEventListener("mozvisibilitychange",o):(l="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",o):(l="msHidden")in document?document.addEventListener("msvisibilitychange",o):"onfocusin"in document?document.onfocusin=document.onfocusout=o:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=o});
//@ sourceMappingURL=setup.js.map