define(["underscore","cilantro","../tables"],function(e,t,n){var r=t.ui.ResultsWorkflow.extend({template:"varify/workflows/results",_ui:{viewPhenotype:".phenotype-modal .modal-body .span12",recalculateButton:"[data-target=recalculate-rankings]",phenotypeWarning:"[data-target=phenotype-warning]"},_events:{"click .export-options-modal [data-save]":"onExportClicked","click .export-options-modal [data-dismiss=modal]":"onExportCloseClicked","show.bs.modal .phenotype-modal":"viewPhenotypesClicked","hidden.bs.modal .phenotype-modal":"hidePhenotypes","click [data-target=recalculate-rankings]":"recalculateRankingsClicked"},_regions:{resultDetailsModal:".result-details-modal"},initialize:function(){e.extend({},this._ui,this.ui),e.extend({},this._events,this.events),e.extend({},this._regions,this.regions),t.on("resultRow:click",function(e,n){t.dialogs.resultDetails.open(e,n)}),t.ui.ResultsWorkflow.prototype.initialize.call(this)},onExportCloseClicked:function(){e.delay(function(){this.columns.currentView.resetFacets()},25)},onExportClicked:function(){this.columns.currentView.data.facets.length===0?(this.$("#export-error-message").html("One or more columns must be selected. Click the &quot;Columns&quot; tab, add at least one column using the green &quot;plus&quot; buttons next to the column names, and click &quot;Export&quot; to try again."),this.$(".export-options-modal .alert-block").show()):e.isEqual(e.pluck(this.data.view.facets.models,"id"),e.pluck(this.columns.currentView.data.facets.models,"id"))?this.exportData():(this.data.view.facets.reset(this.columns.currentView.data.facets.toJSON()),this.data.view.save({},{success:this.exportData}))},onRender:function(){$(document).on("scroll",this.onPageScroll),t.isSupported("2.1.0")||(this.ui.saveQueryToggle.remove(),this.ui.saveQuery.remove()),this.paginator.show(new t.ui.Paginator({model:this.data.results})),this.count.show(new t.ui.ResultCount({model:this.data.results})),this.exportTypes.show(new t.ui.ExportTypeCollection({collection:this.data.exporters})),this.exportProgress.show(new t.ui.ExportProgressCollection({collection:this.data.exporters})),this.table.show(new n.ResultTable({view:this.data.view,collection:this.data.results})),this.ui.navbarButtons.tooltip({animation:!1,placement:"bottom"})}});return{ResultsWorkflow:r}})